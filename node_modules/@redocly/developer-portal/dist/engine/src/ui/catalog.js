import*as React from"react";import{useStaticQuery,graphql}from"gatsby";import{withPathPrefix}from"../utils";export function useCatalog({offset:a=0,limit:b=10}={}){const{siteConfig:{withRbac:d},site:{pathPrefix:e},apiCatalog:c}=useStaticQuery(graphql`
    {
      siteConfig {
        withRbac
      }
      site {
        pathPrefix
      }
      apiCatalog {
        title
        link
        permission
        versions {
          metadata
          summary
          link
          isDefault
        }
        defaultVersion {
          metadata
          summary
          link
          isDefault
        }
      }
    }
  `),[f,g]=React.useState(null),[h,i]=React.useState(d);React.useEffect(()=>{d&&async function(){return"development"===process.env.NODE_ENV?void setTimeout(()=>i(!1),1e3):void(g(await loadRbacCatalog(e,{offset:a,limit:b})),i(!1))}()},[d,a,b]);const{apis:j,totalCount:k}=f?f:{apis:c,totalCount:c.length},l=Math.ceil(k/b),m=Math.floor(a/b)+1;return{apis:j.slice(a,a+b),totalCount:k,totalPages:l,page:m,loadingRbac:h}}async function loadRbacCatalog(a,{offset:b,limit:c}){try{return await(await fetch(withPathPrefix(`_auth/catalog?offset=${b}&limit=${c}`,a))).json()}catch(a){return console.log(a),null}}