"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),code_builder_1=require("../../helpers/code-builder"),code_helpers_1=require("../../helpers/code-helpers"),constants_1=require("../../helpers/constants"),__1=require("../.."),utils_1=require("../../../../utils"),utils_2=require("./utils"),indent=1,contentType={X_FORM_URLENCODED:"application/x-www-form-urlencoded",JSON:"application/json",FORM_DATA:"multipart/form-data"},handler=function(e,t,a){var s,r,i,n,l,o=a.target,p=a.client,u=Object.assign({indent:"  ",showBoilerplate:!0,printBody:!0},t),d=new code_builder_1.CodeBuilder({indentation:u.indent,variablesPrefix:u.variablesPrefix,lang:constants_1.Lang.R}),_=e.method.toUpperCase(),c=null===(s=e.securityOAuth2ExtraCalls)||void 0===s?void 0:s[0];if(u.showBoilerplate&&d.push("library(httr)").blank(),c){var h="oauth2_",b=new __1.HTTPSnippet(c).convert(o,p,(0,tslib_1.__assign)((0,tslib_1.__assign)({},u),{variablesPrefix:h,showBoilerplate:!1}));d.push(b).push('access_token = content(oauth2_data_req, "parsed")$access_token').blank(),e.allHeaders.Authorization='paste("Bearer", access_token)'}var v="";if(null==e?void 0:e.postData)switch((0,utils_1.normalizeMimeType)(null===(r=null==e?void 0:e.postData)||void 0===r?void 0:r.mimeType)){case contentType.X_FORM_URLENCODED:l="form",v=d.var("body");var y=(0,utils_2.postDataToRListBody)(e.postData.params,u);d.push(v+" <- list("+y+")").blank();break;case contentType.JSON:l="json",v=d.var("body");y=(0,utils_2.objectToRString)(e.postData.jsonObj,u);d.push(v+" = '"+y+"'").blank();break;case contentType.FORM_DATA:l="multipart",v=d.var("body");y=(0,utils_2.postDataToRListBody)(e.postData.params,u);d.push(v+" <- list("+y+")").blank();break;default:(null===(i=e.postData)||void 0===i?void 0:i.text)&&(v=d.var("body"),l="raw",d.push(v+" = "+(0,utils_2.objectToRString)(null===(n=e.postData)||void 0===n?void 0:n.text)).blank())}(0,code_helpers_1.printUrlVariablesDeclarations)(e,d),Object.keys((0,tslib_1.__assign)((0,tslib_1.__assign)({},e.pathParameters),e.serverVariables)).length&&d.blank().push("# create you own operator").push('"%&%" <- function(x, y)paste0(x,y)').blank();var k=(0,code_helpers_1.buildUrlExpression)(e,d);d.push("url = "+k).blank();var f=d.var("data_req");if(d.push(f+" <- "+_+"("),d.push(indent,"url,"),e.basicAuth){var D=e.basicAuth,m=D.username,O=D.password;d.push(indent,'authenticate("'+m+'", "'+O+'")')}if(Object.keys(e.allHeaders).length){var T=""+Object.keys(e.allHeaders).map((function(t){return'"'+t+'" = '+(e.allHeaders[t].startsWith("paste")?e.allHeaders[t]:'"'+e.allHeaders[t]+'"')})).join(", ");T&&d.push(indent,"add_headers("+T+"),")}return v&&(d.push(indent,"body = "+v+","),d.push(indent,'encode = "'+l+'",')),d.push(indent,"verbose()"),d.push(")"),u.printBody&&d.blank().push("content("+f+("raw"===l?', "text"':"")+")"),d.join()};exports.default=handler;
//# sourceMappingURL=httr.js.map