"use strict";var _this=this;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RequestBody=void 0;var tslib_1=require("tslib"),React=(0,tslib_1.__importStar)(require("react")),react_1=require("react"),mobx_react_1=require("mobx-react"),deepmerge_1=(0,tslib_1.__importDefault)(require("deepmerge")),redoc_lib_1=require("../../redoc-lib"),CodemirrorInput_1=(0,tslib_1.__importDefault)(require("./CodemirrorInput")),RequestMimeLabel_1=require("./RequestMimeLabel"),Samples_1=require("../Samples"),utils_1=require("../../services/utils"),RequestBodyForm_1=require("./RequestBodyForm"),helper_1=require("../common/FileUpload/helper"),models_1=require("../../models"),Dropdown_1=require("../common/Dropdown");exports.RequestBody=(0,mobx_react_1.observer)((function(e){var r,t=e.properties,a=void 0===t?{}:t,i=(0,tslib_1.__rest)(e,["properties"]),o=i.body.content,l=i.console.formApi,n=function(e){var r;if(!o||!o.hasSample)return"";var t=null===(r=o.active)||void 0===r?void 0:r.examples;if(!(null==t?void 0:t[e]))return"";var i=(0,deepmerge_1.default)(null==t?void 0:t[e].value,a,{arrayMerge:utils_1.arrayMergeStrategy});return JSON.stringify(i,null,2)},u=null===(r=null==o?void 0:o.operation)||void 0===r?void 0:r.activeExampleName,d=function(e){var r;null===(r=null==o?void 0:o.operation)||void 0===r||r.activateExampleName(e),l.setValue("body",n(e))},s=function(e){if(!e)return"";if("application/x-www-form-urlencoded"===e.mime)return e.value;var r=(0,deepmerge_1.default)(e.value,a,{arrayMerge:utils_1.arrayMergeStrategy});return JSON.stringify(r,null,2)},m=function(e,r){return(0,tslib_1.__awaiter)(void 0,void 0,void 0,(function(){return(0,tslib_1.__generator)(this,(function(t){return(0,l.setValue)("body."+e,r),[2]}))}))};(0,react_1.useEffect)((function(){!1!==u?u&&l.setValue("body",n(u)):l.setValue("body",JSON.stringify(a,null,2))}),[u]);var _=i.validate,c=i.body;return React.createElement(React.Fragment,null,React.createElement(redoc_lib_1.MediaTypesSwitch,{content:c.content,renderDropdown:function(e){return React.createElement(redoc_lib_1.DropdownOrLabel,(0,tslib_1.__assign)({},e,{variant:"dark",fullWidth:!0,Label:RequestMimeLabel_1.RequestMimeLabel,Dropdown:Dropdown_1.Dropdown}))}},(function(e){var r,t=e.examples||{},a=Object.keys(t),o=e.schema,n=(0,helper_1.isRootFileUpload)(o||{},e.name)||e.name===models_1.MediaTypes.MULTIPART||e.name===models_1.MediaTypes.URL_ENCODED,u=(0,Samples_1.useExampleKey)(e.operation,t).exampleKey,c=t[u];return React.createElement(React.Fragment,null,a.length&&1!==a.length&&React.createElement(Samples_1.ExampleSwitch,{examples:t,onChange:d,exampleKey:u})||null,n?React.createElement(RequestBodyForm_1.RequestBodyForm,{mediaType:e,formApi:l,onChange:m.bind(_this)}):React.createElement(CodemirrorInput_1.default,{id:"body"+i.id,field:"body",initialValue:s(c),schema:((null===(r=null==i?void 0:i.resolvedBody)||void 0===r?void 0:r.content[e.name])||{}).schema,mode:e.name,validate:_}))})))}));
//# sourceMappingURL=RequestBody.js.map