"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RedoclyReferenceDocsMultiStandalone=exports.RedoclyReferenceDocsStandalone=exports.RedoclyReferenceDocs=exports.CssFixes=void 0;var tslib_1=require("tslib"),React=(0,tslib_1.__importStar)(require("react")),mobx_react_1=require("mobx-react"),mobx_1=require("mobx"),redoc_lib_1=require("../redoc-lib"),Search_1=require("./Search"),NextSectionButton_1=require("./NextSectionButton"),StoreProvider_1=require("./StoreProvider"),store_types_1=require("../services/store-types"),ConsoleLazy_1=require("./console/ConsoleLazy"),ProProviders_1=require("./ProProviders"),Overlay_1=require("./Overlay"),VersionedSpecStore_1=require("../services/VersionedSpecStore"),VersionSwitcher_1=require("./VersionSwitcher"),styled_elements_1=require("./styled.elements"),DownloadButton_1=require("../redoc-lib/src/components/DownloadButton");(0,mobx_1.configure)({useProxies:"ifavailable"}),exports.CssFixes=(0,redoc_lib_1.createGlobalStyle)(templateObject_1||(templateObject_1=(0,tslib_1.__makeTemplateObject)(['\n  div[data-section-id]::after {\n    content: " ";\n    display: block;\n    height: 0;\n    clear: both;\n    visibility: hidden;\n  }\n\n  ',"  {\n    ","\n  }\n\n  ",", ","  {\n    ","\n  }\n\n  ",", "," {\n    ","\n  }\n\n  "," {\n    ",";\n  }\n"],['\n  div[data-section-id]::after {\n    content: " ";\n    display: block;\n    height: 0;\n    clear: both;\n    visibility: hidden;\n  }\n\n  ',"  {\n    ","\n  }\n\n  ",", ","  {\n    ","\n  }\n\n  ",", "," {\n    ","\n  }\n\n  "," {\n    ",";\n  }\n"])),redoc_lib_1.RightPanel,(function(e){var t,o=e.theme,n=e.showRightPanel,r=e.layout;return(0,redoc_lib_1.mediaCSS)({width:r===store_types_1.LayoutVariant.STACKED?"100%":"",paddingLeft:r===store_types_1.LayoutVariant.STACKED?o.spacing.sectionHorizontal:"",display:n?"":(t={},t[redoc_lib_1.ZERO_BREAKPOINT]="",t[o.rightPanel.showAtBreakpoint]="none",t)})}),styled_elements_1.BackgroundStub,styled_elements_1.BackgroundStubFix,(function(e){var t,o=e.theme,n=e.showRightPanel,r=e.layout;return(0,redoc_lib_1.mediaCSS)({display:n&&r!==store_types_1.LayoutVariant.STACKED?"":(t={},t[redoc_lib_1.ZERO_BREAKPOINT]="",t[o.rightPanel.showAtBreakpoint]="none",t)})}),redoc_lib_1.MiddlePanel,styled_elements_1.NextSectionButtonWrap,(function(e){var t,o,n,r=e.theme,a=e.showRightPanel,i=e.layout;return(0,redoc_lib_1.mediaCSS)({maxWidth:a&&i===store_types_1.LayoutVariant.THREE_PANEL?(0,redoc_lib_1.mediaMap)(r.breakpoints,[r.layout["three-panel"].middlePanelMaxWidth],(t={},t[redoc_lib_1.ZERO_BREAKPOINT]=function(){return"none"},t[r.rightPanel.showAtBreakpoint]=function(e){return e},t)):"none",margin:a&&i===store_types_1.LayoutVariant.THREE_PANEL?(0,redoc_lib_1.mediaMap)(r.breakpoints,[r.rightPanel.width,r.layout["three-panel"].middlePanelMaxWidth],(o={},o[redoc_lib_1.ZERO_BREAKPOINT]=function(){return"0"},o[r.rightPanel.showAtBreakpoint]=function(e,t){return t&&"none"!==t?"0 max(calc((100% - "+e+" - "+t+"}) / 2), 0px)":"0"},o)):"0",paddingRight:i===store_types_1.LayoutVariant.STACKED?r.spacing.sectionHorizontal:"",width:a&&i===store_types_1.LayoutVariant.THREE_PANEL?"":(n={},n[redoc_lib_1.ZERO_BREAKPOINT]="",n[r.rightPanel.showAtBreakpoint]="100%",n)})}),styled_elements_1.ApiContentWrap,(function(e){var t,o=e.theme,n=e.showRightPanel,r=e.layout;return(0,redoc_lib_1.mediaCSS)({width:(t={},t[redoc_lib_1.ZERO_BREAKPOINT]="none",t.small="calc(100% - "+o.sidebar.width+")",t),maxWidth:o.layout[r===store_types_1.LayoutVariant.THREE_PANEL&&n?store_types_1.LayoutVariant.THREE_PANEL:store_types_1.LayoutVariant.STACKED].maxWidth})}));var RedoclyReferenceDocs=function(e){function t(t){var o=e.call(this,t)||this;return Object.defineProperty(o,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_updatedItems",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(o,"rootElementRef",{enumerable:!0,configurable:!0,writable:!0,value:React.createRef()}),Object.defineProperty(o,"handleClose",{enumerable:!0,configurable:!0,writable:!0,value:function(){return o.props.store.tryItOut()}}),o.state={searchPopUpShown:!1,searchPopUpValue:""},o}return(0,tslib_1.__extends)(t,e),Object.defineProperty(t.prototype,"componentDidMount",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;this.props.store.onDidMount(),this._observer=(0,mobx_1.reaction)((function(){return e.props.store.menu.renderItems}),(function(){e._updatedItems=!0}))}}),Object.defineProperty(t.prototype,"componentDidUpdate",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._updatedItems&&(this._updatedItems=!1,this.props.store.menu.scrollToActive())}}),Object.defineProperty(t.prototype,"componentWillUnmount",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.props.store.dispose(),this._observer()}}),Object.defineProperty(t.prototype,"render",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=this.props,o=t.store,n=t._forceRenderInfo,r=o.definition,a=o.menu,i=o.options,l=o.search,c=o.marker,s=i.hideDownloadButton,d=i.hideInfoSection,u=i.pagination,_=i.disableSidebar,p=a.renderItems,h="none"===u||a.activeRenderItemIdx<=0,m=!d&&h;m&&"none"!==u&&_&&p[0]&&"section"!==p[0].type&&(m=!1),n&&(m=!0);var y=!m&&null!==s&&!s&&h;return React.createElement(ProProviders_1.ProProviders,{store:o},React.createElement(styled_elements_1.RedocWrap,{className:"redoc-wrap",ref:this.rootElementRef},React.createElement(Overlay_1.Overlay,{l:o.l}),React.createElement(exports.CssFixes,{whiteLabel:i.whiteLabel,showRightPanel:o.showRightPanel,layout:o.layout}),o.tryItOperation&&React.createElement(ConsoleLazy_1.Console,{rootElement:this.rootElementRef.current,store:o,operation:o.tryItOperation,onClose:this.handleClose}),!i.disableSidebar&&React.createElement(redoc_lib_1.StickyResponsiveSidebar,{menu:a,className:"menu-content"},!i.hideLogo&&React.createElement(redoc_lib_1.ApiLogo,{info:r.info}),r instanceof VersionedSpecStore_1.VersionedSpecStore&&React.createElement(VersionSwitcher_1.VersionSwitcher,{spec:r,onChange:function(e){void 0!==e.idx&&r.changeVersion(e.idx),a.updateItemsByVersionChange(!0),o.tryItOut(void 0)}}),!i.disableSearch&&React.createElement(Search_1.SearchField,{showPopUp:function(){return e.setState({searchPopUpShown:!0})},searchValue:this.state.searchPopUpValue,marker:c,setSearchValue:function(t){return e.setState({searchPopUpValue:t})}}),React.createElement(redoc_lib_1.SideMenu,{menu:a})),React.createElement(styled_elements_1.ApiContentWrap,{className:(o.isLoading?"loading ":"")+"api-content",layout:o.layout===store_types_1.LayoutVariant.THREE_PANEL&&o.showRightPanel?store_types_1.LayoutVariant.THREE_PANEL:store_types_1.LayoutVariant.STACKED},i.theme.layout.showDarkRightPanel&&o.showRightPanel&&o.layout!==store_types_1.LayoutVariant.STACKED&&React.createElement(styled_elements_1.BackgroundStub,null),m&&React.createElement(redoc_lib_1.ApiInfo,{store:o}),y&&React.createElement(DownloadButton_1.DownloadButtonWithLabel,{store:o}),React.createElement(redoc_lib_1.ContentItems,{items:p,store:o}),i.showNextButton&&React.createElement(NextSectionButton_1.ContinueButton,{pagination:i.pagination,menu:a}),this.props.children),React.createElement(styled_elements_1.ControlsWrap,null,React.createElement(styled_elements_1.ToggleRightPanelButton,{store:o,isVisible:o.layout===store_types_1.LayoutVariant.THREE_PANEL}),React.createElement(styled_elements_1.ChangeViewButton,{store:o,isVisible:o.showRightPanel})),React.createElement(Search_1.ProSearchBox,{search:l,marker:c,menu:a,onActivate:a.activateAndScroll.bind(a),options:i,shown:this.state.searchPopUpShown,hidePopUp:function(){return e.setState({searchPopUpShown:!1})},showPopUp:function(){return e.setState({searchPopUpShown:!0})},setSearchValue:function(t){return e.setState({searchPopUpValue:t})},searchValue:this.state.searchPopUpValue}),i.theme.layout.showDarkRightPanel&&o.showRightPanel&&o.layout!==store_types_1.LayoutVariant.STACKED&&React.createElement(styled_elements_1.BackgroundStubFix,null)))}}),t=(0,tslib_1.__decorate)([mobx_react_1.observer],t)}(React.Component);function RedoclyReferenceDocsStandalone(e){var t=e.definition,o=e.definitionUrl,n=e.options,r=void 0===n?{}:n,a=e.activeItemId,i=e.activeSampleLanguage,l=e.activeDeepLink,c=(0,redoc_lib_1.argValueToBoolean)(r.hideLoading,!1),s=new redoc_lib_1.RedocNormalizedOptions(r),d=React.createElement(StoreProvider_1.ProStoreProvider,{definition:t,definitionUrl:o,options:r,activeItemId:a,activeSampleLanguage:i,activeDeepLink:l},(function(e){var t=e.loading,o=e.store;return t?c?null:React.createElement(redoc_lib_1.Loading,{color:s.theme.colors.primary.main}):React.createElement(RedoclyReferenceDocs,{store:o})}));return r.disableErrorBoundary?d:React.createElement(redoc_lib_1.ErrorBoundary,null,d)}exports.RedoclyReferenceDocs=RedoclyReferenceDocs,exports.RedoclyReferenceDocsStandalone=RedoclyReferenceDocsStandalone;var templateObject_1,RedoclyReferenceDocsMultiStandalone=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,tslib_1.__extends)(t,e),Object.defineProperty(t.prototype,"render",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.props,t=e.definitions,o=e.options,n=void 0===o?{}:o,r=(0,redoc_lib_1.argValueToBoolean)(n.hideLoading,!1),a=new redoc_lib_1.RedocNormalizedOptions(n);return React.createElement(redoc_lib_1.ErrorBoundary,null,React.createElement(StoreProvider_1.ProStoreProvider,{definitions:t,options:n},(function(e){var t=e.loading,o=e.store;return t?r?null:React.createElement(redoc_lib_1.Loading,{color:a.theme.colors.primary.main}):React.createElement(RedoclyReferenceDocs,{store:o})})))}}),t}(React.Component);exports.RedoclyReferenceDocsMultiStandalone=RedoclyReferenceDocsMultiStandalone;
//# sourceMappingURL=RedoclyReferenceDocs.js.map