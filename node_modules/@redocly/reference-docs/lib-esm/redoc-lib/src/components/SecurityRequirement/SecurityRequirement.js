import{__makeTemplateObject}from"tslib";import React,{useState}from"react";import styled from"../../styled-components";import{StyledMarkdownBlock}from"../Markdown/styled.elements";import{useStore}from"../StoreBuilder";import{Markdown}from"../Markdown/Markdown";import{titleize}from"../../utils";import{OAuthFlow}from"../SecuritySchemes/SecuritySchemes";import{l}from"../../services/Labels";import{ContentPanel}from"../../../../components/Panel";import{SecurityRequirementPanelDescription}from"./SecurityRequirementPanelDescription";import{SecurityRequirementElement}from"./SecurityRequirementElement";import{RequiredScopesRow}from"./RequiredScopesRow";export var AUTH_TYPES={oauth2:"OAuth2",apiKey:"API Key",http:"HTTP",openIdConnect:"OpenID Connect"};function getRequiredScopes(e,t){for(var n=[],r=t.length;r--;)for(var o=t[r],c=o.schemes.length;c--;){var a=o.schemes[c];a.id===e&&n.push.apply(n,a.scopes)}return Array.from(new Set(n))}export var SecurityRequirements=function(e){var t=e.securities,n=useStore(),r=null==n?void 0:n.options.showSecuritySchemeType,o=useState(!1),c=o[0],a=o[1];if(!t.length)return null;var i=null==n?void 0:n.definition.securitySchemes.schemes,m=null==i?void 0:i.filter((function(e){var n=e.id;return t.find((function(e){return e.schemes.find((function(e){return e.id===n}))}))}));return React.createElement(ContentPanel,{header:l("authorizations"),onToggle:function(e){return a(e)},description:!c&&React.createElement(SecurityRequirementPanelDescription,{securities:t,showSecuritySchemeType:r}),expanded:c},c&&m&&m.length>1?React.createElement(SecurityRequirementBlock,null,t.map((function(e,n){var o,c,a="";return t.length>1&&e.schemes.length>1&&(c=0===n?"(":"",a=")"),n!==t.length-1&&(a+=" or",o=React.createElement("br",null)),React.createElement(React.Fragment,{key:n},c,React.createElement(SecurityRequirementElement,{key:n,security:e,showSecuritySchemeType:r}),a,o)}))):null,c&&m?m.map((function(e,n){var r=getRequiredScopes(e.id,t),o=React.createElement(RequiredScopesRow,{scopes:r});return React.createElement(SecurityDetails,{key:n},React.createElement("h5",null,React.createElement(LockIcon,null)," ",AUTH_TYPES[e.type]||e.type,": ",e.id),React.createElement(Markdown,{source:e.description||""}),React.createElement(StyledMarkdownBlock,{key:e.id},e.apiKey?React.createElement(React.Fragment,null,React.createElement(SecurityRow,null,React.createElement("b",null,titleize(e.apiKey.in||"")," parameter name: "),React.createElement("code",null,e.apiKey.name)),o):e.http?React.createElement(React.Fragment,null,React.createElement(SecurityRow,null,React.createElement("b",null,"HTTP Authorization Scheme: "),React.createElement("code",null,e.http.scheme)),React.createElement(SecurityRow,null,"bearer"===e.http.scheme&&e.http.bearerFormat&&React.createElement(React.Fragment,null,React.createElement("b",null,"Bearer format: "),React.createElement("code",null,e.http.bearerFormat))),o):e.openId?React.createElement(React.Fragment,null,React.createElement(SecurityRow,null,React.createElement("b",null,"Connect URL: "),React.createElement("code",null,React.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e.openId.connectUrl},e.openId.connectUrl))),o):e.flows?Object.keys(e.flows).map((function(t){return React.createElement(OAuthFlow,{key:t,type:t,RequiredScopes:o,flow:e.flows[t]})})):null))})):null)};var templateObject_1,templateObject_2,templateObject_3,SecurityDetails=styled.div(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  border-bottom: 1px solid ",";\n  margin-bottom: 1.5em;\n  padding-bottom: 0.7em;\n  &:last-child {\n    border-bottom: none;\n    margin-bottom: 0;\n    padding-bottom: 0;\n  }\n  h5 {\n    line-height: 1em;\n    margin: 0 0 0.6em;\n    font-size: ",";\n  }\n  .redoc-markdown p:first-child {\n    display: inline;\n  }\n"],["\n  border-bottom: 1px solid ",";\n  margin-bottom: 1.5em;\n  padding-bottom: 0.7em;\n  &:last-child {\n    border-bottom: none;\n    margin-bottom: 0;\n    padding-bottom: 0;\n  }\n  h5 {\n    line-height: 1em;\n    margin: 0 0 0.6em;\n    font-size: ",";\n  }\n  .redoc-markdown p:first-child {\n    display: inline;\n  }\n"])),(function(e){return e.theme.colors.border.light}),(function(e){return e.theme.typography.fontSize})),SecurityRequirementBlock=styled.div(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  margin-bottom: 20px;\n  background-color: ",";\n  border-radius: ",";\n  padding: ",";\n"],["\n  margin-bottom: 20px;\n  background-color: ",";\n  border-radius: ",";\n  padding: ",";\n"])),(function(e){return e.theme.colors.secondary.main}),(function(e){return e.theme.shape.borderRadius}),(function(e){var t=e.theme;return t.sidebar.spacing.unit+"px "+1.2*t.sidebar.spacing.unit+"px"})),LockIcon=function(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"11",height:"11"},React.createElement("path",{fill:"currentColor",d:"M18 10V6A6 6 0 0 0 6 6v4H3v14h18V10h-3zM8 6c0-2.206 1.794-4 4-4s4 1.794 4 4v4H8V6zm11 16H5V12h14v10z"}))};export var SecurityRow=styled.div(templateObject_3||(templateObject_3=__makeTemplateObject(["\n  margin: 0.5em 0;\n"],["\n  margin: 0.5em 0;\n"])));
//# sourceMappingURL=SecurityRequirement.js.map