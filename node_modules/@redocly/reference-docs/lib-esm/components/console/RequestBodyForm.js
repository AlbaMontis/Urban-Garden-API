import{__makeTemplateObject}from"tslib";import React,{useEffect}from"react";import{observer}from"mobx-react";import{isMultipartFileUploadProperty,isRootFileUpload,mimeTypeToAccept}from"../common/FileUpload/helper";import{FormControl,FormLabel}from"../common/form";import{styled}from"../../redoc-lib";import{FileUpload}from"../common/FileUpload";import{FormTextField,invertedInputStyles}from"../common/TextField";import{DefinitionTypes,MediaTypes}from"../../models";import{useExampleKey}from"../Samples";export var RequestBodyForm=observer((function(e){var t,o=e.mediaType,l=e.onChange,n=e.formApi,a=o.examples||{},m=useExampleKey(o.operation,a).exampleKey,r=null===(t=a[m])||void 0===t?void 0:t.rawValue,i=getRequestBodyFormFields(o);useEffect((function(){return n&&i.forEach((function(e){var t,o,l=null==r?void 0:r[e.name],a=null!==(o=null!==(t=e.example)&&void 0!==t?t:null==l?void 0:l.example)&&void 0!==o?o:l;void 0!==a&&n.setValue("body."+e.name,""+a)}))}),[m]);var p=o.schema||{};return isRootFileUpload(p,o.name)?React.createElement(FileFormControlWrapper,null,React.createElement(FormControl,null,React.createElement(StyledFileUpload,{fullWidth:!0,id:"body."+o.name,name:"body."+o.name,accept:mimeTypeToAccept(o.name),schema:p,contentName:o.name,onChange:l}))):p.type===DefinitionTypes.OBJECT||i?React.createElement(FileFormControlWrapper,null,i.map((function(e){var t=e.schema||{},n=o.name===MediaTypes.MULTIPART&&isMultipartFileUploadProperty(t),a=t.contentMediaType||"",m=n?React.createElement(StyledFileUpload,{fullWidth:!0,id:"body."+e.name,name:"body."+e.name,accept:mimeTypeToAccept(a),multiple:"array"===t.type,schema:t,contentName:e.name,onChange:l}):React.createElement(FormTextField,{fullWidth:!0,id:"body."+e.name,field:"body."+e.name,placeholder:t.description||e.name});return React.createElement(FormControl,{key:e.name},React.createElement(FormLabel,null,e.name,":"),m)}))):(console.warn('Invalid schema for request body and mime type: "'+o.name+'"',p),null)}));export function getRequestBodyFormFields(e){var t,o,l,n,a;return((null===(o=null===(t=e.schema)||void 0===t?void 0:t.oneOf)||void 0===o?void 0:o.length)?(null===(l=e.schema)||void 0===l?void 0:l.oneOf[null===(n=e.schema)||void 0===n?void 0:n.activeOneOf].fields)||[]:(null===(a=e.schema)||void 0===a?void 0:a.fields)||[]).filter((function(e){return!e.schema.readOnly}))}var templateObject_1,templateObject_2,FileFormControlWrapper=styled.div(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  > div {\n    margin-top: 10px;\n  }\n"],["\n  > div {\n    margin-top: 10px;\n  }\n"]))),StyledFileUpload=styled(FileUpload)(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  ","\n  ",";\n  ","\n"],["\n  ","\n  ",";\n  ","\n"])),invertedInputStyles,(function(e){return"password"===e.inputType?"padding-right: 40px;":""}),(function(e){return e.fullWidth?"width: 100%;":""}));
//# sourceMappingURL=RequestBodyForm.js.map